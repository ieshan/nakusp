services:
  nakusp:
    build:
      context: .
      dockerfile: Dockerfile.dev
    image: nakusp-dev:0.0.1
    volumes:
      - "./:/app"
    networks:
      - nakusp-network
    depends_on:
      - redis
    command: "go test ./..."
    stop_signal: SIGINT
    environment:
      REDIS_URI: "redis://redis:6379/0"
  nakusp-test:
    image: nakusp-dev:0.0.1
    volumes:
      - "./:/app"
    networks:
      - nakusp-network
    depends_on:
      - redis
    command: "go test ./..."
    stop_signal: SIGINT
    environment:
      REDIS_URI: "redis://redis:6379/0"
  redis:
    image: redis:8.2.2-alpine3.22
    restart: always
    networks:
      - nakusp-network
networks:
  nakusp-network:
    driver: bridge

